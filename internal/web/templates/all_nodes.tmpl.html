{{define "title"}}All Nodes - WPAmesh{{end}}

{{define "content"}}

<div id="tables-example">
    <div class="table-controls">
        <h3>All Nodes</h3>
        <div class="filter-controls">
            <input type="hidden" id="filter-connected" checked>
            <label class="mg-toggle mg-text-s">Valid Gateways Only<input type="checkbox" id="filter-gateway"> <span class="mg-toggle--icon mg-icon--s"></span></label>
            <label class="mg-toggle mg-text-s">Auto-Refresh (15s)<input type="checkbox" id="auto-refresh"> <span class="mg-toggle--icon mg-icon--s"></span></label>
        </div>
    </div>
    <table class="table--responsive" id="nodes-table">
        <thead>
            <tr>
                <th>Node ID</th>
                <th colspan="2">Name</th>
                <th>Proxy Type</th>
                <th>Address</th>
                <th>Downlink?</th>
                <th>Valid <abbr title="gateway">GW</abbr>?</th>
                <th>User</th>
            </tr>
        </thead>
        <tbody id="nodes-tbody">
            <tr>
                <td colspan="8" class="loading-message">Loading...</td>
            </tr>
        </tbody>
    </table>

    <h3>Other Connections</h3>
    <table class="table--responsive" id="other-clients-table">
        <thead>
            <tr>
                <th>Client ID</th>
                <th>Address</th>
                <th>User</th>
            </tr>
        </thead>
        <tbody id="other-clients-tbody">
            <tr>
                <td colspan="3" class="loading-message">Loading...</td>
            </tr>
        </tbody>
    </table>
</div>

<script>
    // Initialize node loading on page load
    window.isAdmin = true; // Admin page

    // Ensure DOM is loaded before calling loadNodes
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof loadNodes === 'function') {
                loadNodes(window.isAdmin);
            }
        });
    } else {
        // DOM already loaded
        if (typeof loadNodes === 'function') {
            loadNodes(window.isAdmin);
        }
    }
</script>

{{end}}